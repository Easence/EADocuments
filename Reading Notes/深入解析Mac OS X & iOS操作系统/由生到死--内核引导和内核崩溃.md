#由生到死--内核引导和内核崩溃
## XNU内核的编译
参考[Building xnu for OS X 10.11 El Capitan][2],但是还没有成功编译通过。。。

## 一个内核，支持多种架构
- osfmk目录包含了架构相关的子目录（如：i386，x86_64）。
- pexpert目录（即，Platform Expert的目录）,规模不大，但很重要，包含了每个架构的个性化函数。
- i386的Platform Expert与EFI紧密结合，而ARM的Platform Expert则跟iBoot紧密结合。pexpert目录的结构如下表：
 ![pexpert结构][1]

## 内核代码树
- 可以使用[FXR浏览工具](http://fxr.watson.org)查看源码。
- XNU主目录结构：
	![XNU主目录结构][3]
	
- BSD目录结构：
	![BSD目录结构][4]
	
- OSFMK目录结构：
	![OSFMK目录结构][5]	

## XNU的引导过程
**XNU是一个Mach-O二进制文件，引导加载器（EFI或iBoot）中包含了解析Mach-O文件的代码，可以通过LC_UNIXTHREAD命令计算出入口点。**

### 从高层次看XNU的引导过程


---
[1]: https://github.com/Easence/EADocuments/blob/master/Reading%20Notes/深入解析Mac%20OS%20X%20&%20iOS操作系统/Resources/Images/platformExpert.png?raw=true
[2]: https://github.com/Easence/EADocuments/blob/master/Reading%20Notes/深入解析Mac%20OS%20X%20%26%20iOS操作系统/Building%20xnu%20for%20OS%20X%2010.11%20El%20Capitan.md
[3]: https://github.com/Easence/EADocuments/blob/master/Reading%20Notes/深入解析Mac%20OS%20X%20&%20iOS操作系统/Resources/Images/XNU_SubDirectory.png?raw=true
[4]: https://github.com/Easence/EADocuments/blob/master/Reading%20Notes/深入解析Mac%20OS%20X%20&%20iOS操作系统/Resources/Images/BSD_SubDirectory.png?raw=true
[5]: https://github.com/Easence/EADocuments/blob/master/Reading%20Notes/深入解析Mac%20OS%20X%20&%20iOS操作系统/Resources/Images/OSFMK_Subdirectory.png?raw=true

